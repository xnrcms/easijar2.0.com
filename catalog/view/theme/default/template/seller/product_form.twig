{% extends helper.template("seller/_partial/layout") %}

{% block header %}
  <script type="text/javascript">
    var placeholder = "{{ placeholder }}";
    var text_main_image = "{{ text_main_image }}";
    var text_sort = "{{ text_sort }}";
    var text_delete = "{{ text_delete }}";
    var editor_language = "{{ editor_language }}";
  </script>

  <script src="catalog/view/javascript/seller.js" type="text/javascript"></script>
  <script src="catalog/view/javascript/ajaxfileupload.js" type="text/javascript"></script>
  <script src="catalog/view/javascript/tinymce/tinymce.min.js" type="text/javascript"></script>
  <script src="catalog/view/javascript/jquery/datetimepicker/moment/moment.min.js" type="text/javascript"></script>
  <script src="catalog/view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
  <link href="catalog/view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.css" type="text/css" rel="stylesheet" media="screen"/>
  <script type="text/javascript" src="catalog/view/javascript/tinymce/opencart.js"></script>
  <script type="text/javascript" src="catalog/view/javascript/ckfinder/ckfinder.js"></script>
{% endblock %}

{% block content %}
  <div id="content" class="col-sm-12">
    {% if success %}
      <div class="alert alert-success alert-dismissible"><i class="fa fa-check-circle"></i> {{ success }}</div>
    {% endif %}
    {% if error_warning %}
      <div class="alert alert-warning"><i class="fa fa-exclamation-circle"></i> {{ error_warning }}</div>
    {% endif %}
    <div class="row">
      <div class="col-md-12">
        <h2 class="pull-left">{{ heading_title }}</h2>
        <div class="pull-right">
          <button type="submit" form="form-product" data-toggle="tooltip" title="" class="btn btn-primary" data-original-title="{{ text_save }}"><i class="fa fa-save"></i></button>
          <button type="button" id="save-variant" data-toggle="tooltip" title="" class="btn btn-success" data-original-title="{{ text_save_variant }}"><i class="fa fa-save"></i></button>
          <a href="{{ cancel }}" data-toggle="tooltip" title="" class="btn btn-default" data-original-title="{{ text_cancel }}"><i class="fa fa-reply"></i></a>
        </div>
      </div>
    </div>
    <div class="row">
      <div id="filter-product" class="col-sm-12">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h3 class="panel-title"><i class="fa fa-pencil"></i> {{ text_form }}</h3>
          </div>
          <div class="panel-body">
            <form action="{{ action }}" method="post" enctype="multipart/form-data" id="form-product" class="form-horizontal">
              <input type="hidden" name="save_variant" value="0">
              <ul class="nav nav-tabs" style="margin-bottom: 25px;">
                <li class="active"><a href="#tab-general" data-toggle="tab">{{ tab_general }}</a></li>
                <li><a href="#tab-data" data-toggle="tab">{{ tab_data }}</a></li>
                <li><a href="#tab-image" data-toggle="tab">{{ tab_image }}</a></li>
                <li><a href="#tab-links" data-toggle="tab">{{ tab_links }}</a></li>
                {% if product_id %}
                  <li role="presentation" class="dropdown">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                      {{ tab_option }} <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                      <li><a href="{{ option_list }}" target="_blank">{{ tab_option_list }}</a></li>
                      <li><a href="{{ option_add }}" target="_blank">{{ tab_option_add }}</a></li>
                    </ul>
                  </li>
                  <li><a href="javascript:void(0);" id="button-variant">{{ tab_product_children }}</a></li>
                {% endif %}
                <li role="presentation" class="dropdown">
                  <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                    {{ tab_more }} <span class="caret"></span>
                  </a>
                  <ul class="dropdown-menu">
                    <li><a href="#tab-attribute" data-toggle="tab">{{ tab_attribute }}</a></li>
                    <li><a href="#tab-discount" data-toggle="tab">{{ tab_discount }}</a></li>
                    <li><a href="#tab-special" data-toggle="tab">{{ tab_special }}</a></li>
                    <li><a href="#tab-download" data-toggle="tab">{{ tab_download }}</a></li>
                  </ul>
                </li>
              </ul>
              <div class="tab-content">
                <div class="tab-pane active" id="tab-general">
                  <ul class="nav nav-tabs" id="language" style="margin-bottom: 25px;">
                    {% for language in languages %}
                      <li><a href="#language{{ language.language_id }}" data-toggle="tab"><img src="catalog/language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}"/> {{ language.name }}</a></li>
                    {% endfor %}
                  </ul>
                  <div class="tab-content">
                    {% for language in languages %}
                      <div class="tab-pane" id="language{{ language.language_id }}">
                        <div class="form-group required">
                          <label class="col-md-2 control-label" for="input-name{{ language.language_id }}">{{ entry_name }}</label>
                          <div class="col-md-10">
                            <input type="text" name="product_description[{{ language.language_id }}][name]" value="{{ product_description[language.language_id] ? product_description[language.language_id].name }}" placeholder="{{ entry_name }}" id="input-name{{ language.language_id }}" class="form-control"/>
                            {% if error_name[language.language_id] %}
                              <div class="text-danger">{{ error_name[language.language_id] }}</div>
                            {% endif %}
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="col-md-2 control-label" for="input-description{{ language.language_id }}">{{ entry_description }}</label>
                          <div class="col-md-10">
                            <textarea name="product_description[{{ language.language_id }}][description]" placeholder="{{ entry_description }}" id="input-description{{ language.language_id }}" data-toggle="" data-lang="{{ summernote }}" class="form-control tinymce">{{ product_description[language.language_id] ? product_description[language.language_id].description }}</textarea>
                          </div>
                        </div>
                        <div class="form-group required">
                          <label class="col-md-2 control-label" for="input-meta-title{{ language.language_id }}">{{ entry_meta_title }}</label>
                          <div class="col-md-10">
                            <input type="text" name="product_description[{{ language.language_id }}][meta_title]" value="{{ product_description[language.language_id] ? product_description[language.language_id].meta_title }}" placeholder="{{ entry_meta_title }}" id="input-meta-title{{ language.language_id }}" class="form-control"/>
                            {% if error_meta_title[language.language_id] %}
                              <div class="text-danger">{{ error_meta_title[language.language_id] }}</div>
                            {% endif %} </div>
                        </div>
                        <div class="form-group">
                          <label class="col-md-2 control-label" for="input-meta-description{{ language.language_id }}">{{ entry_meta_description }}</label>
                          <div class="col-md-10">
                            <textarea name="product_description[{{ language.language_id }}][meta_description]" rows="5" placeholder="{{ entry_meta_description }}" id="input-meta-description{{ language.language_id }}" class="form-control">{{ product_description[language.language_id] ? product_description[language.language_id].meta_description }}</textarea>
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="col-md-2 control-label" for="input-meta-keyword{{ language.language_id }}">{{ entry_meta_keyword }}</label>
                          <div class="col-md-10">
                            <textarea name="product_description[{{ language.language_id }}][meta_keyword]" rows="5" placeholder="{{ entry_meta_keyword }}" id="input-meta-keyword{{ language.language_id }}" class="form-control">{{ product_description[language.language_id] ? product_description[language.language_id].meta_keyword }}</textarea>
                          </div>
                        </div>
                        <div class="form-group">
                          <label class="col-md-2 control-label" for="input-tag{{ language.language_id }}"><span data-toggle="tooltip" title="{{ help_tag }}">{{ entry_tag }}</span></label>
                          <div class="col-md-10">
                            <input type="text" name="product_description[{{ language.language_id }}][tag]" value="{{ product_description[language.language_id] ? product_description[language.language_id].tag }}" placeholder="{{ entry_tag }}" id="input-tag{{ language.language_id }}" class="form-control"/>
                          </div>
                        </div>
                      </div>
                    {% endfor %}
                  </div>
                </div>
                <div class="tab-pane" id="tab-data">
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-price"><span style="color: red;">*</span>{{ entry_price }}</label>
                    <div class="col-md-10">
                      <div class="input-group">
                        <div class="input-group-addon">{{ currency_code }}</div>
                        <input type="text" name="price" value="{{ price|round(2) }}" placeholder="{{ entry_price }}" id="input-price" class="form-control">
                      </div>
                        {% if error_price %}
                          <div class="text-danger">{{ error_price }}</div>
                        {% endif %}
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-quantity"><span style="color: red;">*</span>{{ entry_quantity }}</label>
                    <div class="col-md-10">
                      <div class="row">
                        <div class="col-md-6">
                          <input type="text" name="quantity" value="{{ quantity }}" placeholder="{{ entry_quantity }}" id="input-quantity" class="form-control"/>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="input-group-addon">{{ entry_minimum }}</div>
                            <input type="text" name="minimum" value="{{ minimum }}" placeholder="{{ entry_minimum }}" id="input-minimum" class="form-control"/>
                          </div>
                        </div>
                        {% if error_quantity %}
                          <div class="text-danger">{{ error_quantity }}</div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-category">{{ entry_category }}</label>
                    <div class="col-md-10">
                      <div class="input-group">
                        <div class="input-group-addon"><i class="fa fa-search" aria-hidden="true"></i></div>
                        <input type="text" name="category" value="" placeholder="{{ entry_category }}" id="input-category" class="form-control"/>
                      </div>
                      <div id="product-category" class="well well-sm" style="min-height: 50px; max-height: 150px; overflow: auto;">
                        {% for product_category in product_categories %}
                          <div id="product-category{{ product_category.category_id }}"><i class="fa fa-minus-circle"></i> {{ product_category.name }}
                            <input type="hidden" name="product_category[]" value="{{ product_category.category_id }}"/>
                          </div>
                        {% endfor %}
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-stock-status"><span data-toggle="tooltip" title="{{ help_stock_status }}">{{ entry_stock_status }}</span></label>
                    <div class="col-md-6">
                      <select name="stock_status_id" id="input-stock-status" class="form-control">
                        {% for stock_status in stock_statuses %}
                          {% if stock_status.stock_status_id == stock_status_id %}
                            <option value="{{ stock_status.stock_status_id }}" selected="selected">{{ stock_status.name }}</option>
                          {% else %}
                            <option value="{{ stock_status.stock_status_id }}">{{ stock_status.name }}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-date-available">{{ entry_date_available }}</label>
                    <div class="col-md-6">
                      <div class="input-group date">
                        <input type="text" name="date_available" value="{{ date_available }}" placeholder="{{ entry_date_available }}" data-date-format="YYYY-MM-DD" id="input-date-available" class="form-control"/>
                        <div class="input-group-btn">
                          <button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-date-until">{{ entry_date_until }}</label>
                    <div class="col-md-6">
                      <div class="input-group date">
                        <input type="text" name="date_until" value="{{ date_until }}" placeholder="{{ entry_date_until }}" data-date-format="YYYY-MM-DD" id="input-date-until" class="form-control"/>
                        <div class="input-group-btn">
                          <button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="form-group hidden">
                    <label class="col-md-2 control-label" for="input-tax-class">{{ entry_tax_class }}</label>
                    <div class="col-md-6">
                      <select name="tax_class_id" id="input-tax-class" class="form-control">
                        <option value="0">{{ text_none }}</option>
                        {% for tax_class in tax_classes %}
                          {% if tax_class.tax_class_id == tax_class_id %}
                            <option value="{{ tax_class.tax_class_id }}" selected="selected">{{ tax_class.title }}</option>
                          {% else %}
                            <option value="{{ tax_class.tax_class_id }}">{{ tax_class.title }}</option>
                          {% endif %}
                        {% endfor %}
                      </select>
                    </div>
                  </div>
                <div class="form-group">
                  <label class="col-md-2 control-label" for="input-model">{{ entry_model }}</label>
                  <div class="col-md-6">
                    <div class="row">
                      <div class="col-md-6">
                        <input type="text" name="model" value="{{ model }}" placeholder="{{ entry_model }}" id="input-model" class="form-control"/>
                      </div>
                      <div class="col-md-6">
                        <div class="input-group">
                          <div class="input-group-addon"><span style="color: red;">*</span>{{ entry_sku }}</div>
                          <input type="text" name="sku" value="{{ sku }}" placeholder="{{ entry_sku }}" id="input-sku" class="form-control"/>
                        </div>
                        {% if error_sku %}
                          <div class="text-danger">{{ error_sku }}</div>
                        {% endif %}
                      </div>
                    </div>
                  </div>
                </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-length">{{ entry_dimension }}</label>
                    <div class="col-md-10">
                      <div class="row">
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="input-group-addon">{{ entry_length }}</div>
                            <input type="text" name="length" value="{{ length }}" placeholder="{{ entry_length }}" id="input-length" class="form-control"/>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="input-group-addon">{{ entry_width }}</div>
                            <input type="text" name="width" value="{{ width }}" placeholder="{{ entry_width }}" id="input-width" class="form-control"/>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="input-group-addon">{{ entry_height }}</div>
                            <input type="text" name="height" value="{{ height }}" placeholder="{{ entry_height }}" id="input-height" class="form-control"/>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <select name="length_class_id" id="input-length-class" class="form-control">
                            {% for length_class in length_classes %}
                              {% if length_class.length_class_id == length_class_id %}
                                <option value="{{ length_class.length_class_id }}" selected="selected">{{ length_class.title }}</option>
                              {% else %}
                                <option value="{{ length_class.length_class_id }}">{{ length_class.title }}</option>
                              {% endif %}
                            {% endfor %}
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-weight">{{ entry_weight }}</label>
                    <div class="col-md-10">
                      <div class="row">
                        <div class="col-md-6">
                          <input type="text" name="weight" value="{{ weight }}" placeholder="{{ entry_weight }}" id="input-weight" class="form-control"/>
                        </div>
                        <div class="col-md-6">
                          <select name="weight_class_id" id="input-weight-class" class="form-control">
                            {% for weight_class in weight_classes %}
                              {% if weight_class.weight_class_id == weight_class_id %}
                                <option value="{{ weight_class.weight_class_id }}" selected="selected">{{ weight_class.title }}</option>
                              {% else %}
                                <option value="{{ weight_class.weight_class_id }}">{{ weight_class.title }}</option>
                              {% endif %}
                            {% endfor %}
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-subtract">{{ entry_subtract }}</label>
                    <div class="col-md-10">
                      <label class="radio-inline"> {% if subtract %}
                          <input type="radio" name="subtract" value="1" checked="checked"/>
                          {{ text_yes }}
                        {% else %}
                          <input type="radio" name="subtract" value="1"/>
                          {{ text_yes }}
                        {% endif %} </label> <label class="radio-inline"> {% if not subtract %}
                          <input type="radio" name="subtract" value="0" checked="checked"/>
                          {{ text_no }}
                        {% else %}
                          <input type="radio" name="subtract" value="0"/>
                          {{ text_no }}
                        {% endif %} </label>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label">{{ entry_shipping }}</label>
                    <div class="col-md-10">
                      {% if shipping_require != 2 %}
                        <label class="radio-inline">
                            <input type="radio" name="shipping" value="1" {% if shipping_require %}checked="checked"{% endif %} disabled="disabled"/>
                            {{ text_yes }}
                        </label>
                        <label class="radio-inline">
                          <input type="radio" name="shipping" value="0" {% if shipping_require == false %}checked="checked"{% endif %} disabled="disabled"/>
                          {{ text_no }}
                        </label>
                      {% else %}
                        <label class="radio-inline">
                          {% if shipping %}
                            <input type="radio" name="shipping" value="1" checked="checked"/>
                            {{ text_yes }}
                          {% else %}
                            <input type="radio" name="shipping" value="1"/>
                            {{ text_yes }}
                          {% endif %} </label>
                        <label class="radio-inline">
                          {% if not shipping %}
                            <input type="radio" name="shipping" value="0" checked="checked"/>
                            {{ text_no }}
                          {% else %}
                            <input type="radio" name="shipping" value="0"/>
                            {{ text_no }}
                          {% endif %}
                        </label>
                      {% endif %}
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-status">{{ entry_status }}</label>
                    <div class="col-md-10">
                      {% if validate and type == 'new' %}
                        <label class="radio-inline">
                          <input type="radio" name="status" value="1" disabled="disabled">
                          {{ text_enabled }}
                        </label>
                        <label class="radio-inline">
                          <input type="radio" name="status" value="0" checked="checked" disabled="disabled">
                          {{ text_disabled }}
                        </label>
                      {% elseif validate and type == 'update' and approved == false %}
                        <label class="radio-inline">
                          <input type="radio" name="status" value="1" disabled="disabled">
                          {{ text_enabled }}
                        </label>
                        <label class="radio-inline">
                          <input type="radio" name="status" value="0" checked="checked" disabled="disabled">
                          {{ text_disabled }}
                        </label>
                      {% else %}
                        <label class="radio-inline"> {% if status %}
                            <input type="radio" name="status" value="1" checked="checked"/>
                            {{ text_enabled }}
                          {% else %}
                            <input type="radio" name="status" value="1"/>
                            {{ text_enabled }}
                          {% endif %} </label> <label class="radio-inline"> {% if not status %}
                          <input type="radio" name="status" value="0" checked="checked"/>
                          {{ text_disabled }}
                        {% else %}
                          <input type="radio" name="status" value="0"/>
                          {{ text_disabled }}
                        {% endif %} </label>
                      {% endif %}
                    </div>
                  </div>
                </div>
                <div class="tab-pane" id="tab-links">
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-manufacturer">{{ entry_manufacturer }}</label>
                    <div class="col-md-10">
                      <div class="input-group">
                        <div class="input-group-addon"><i class="fa fa-search" aria-hidden="true"></i></div>
                        <input type="text" name="manufacturer" value="{{ manufacturer }}" placeholder="{{ entry_manufacturer }}" id="input-manufacturer" class="form-control"/>
                      </div>
                      <input type="hidden" name="manufacturer_id" value="{{ manufacturer_id }}"/>
                    </div>
                  </div>
                  <div class="form-group">
                    <label class="col-md-2 control-label" for="input-related">{{ entry_related }}</label>
                    <div class="col-md-10">
                      <div class="input-group">
                        <div class="input-group-addon"><i class="fa fa-search" aria-hidden="true"></i></div>
                        <input type="text" name="related" value="" placeholder="{{ entry_related }}" id="input-related" class="form-control"/>
                      </div>
                      <div id="product-related" class="well well-sm" style="min-height: 150px; overflow: auto;"> {% for product_related in product_relateds %}
                          <div id="product-related{{ product_related.product_id }}"><i class="fa fa-minus-circle"></i> {{ product_related.name }}
                            <input type="hidden" name="product_related[]" value="{{ product_related.product_id }}"/>
                          </div>
                        {% endfor %}</div>
                    </div>
                  </div>
                </div>
                <div class="tab-pane" id="tab-attribute">
                  <div class="table-responsive">
                    <table id="attribute" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-left">{{ entry_attribute }}</td>
                          <td class="text-left">{{ entry_text }}</td>
                          <td></td>
                        </tr>
                      </thead>
                      <tbody>
                      {% set attribute_row = 0 %}
                      {% for product_attribute in product_attributes %}
                        <tr id="attribute-row{{ attribute_row }}">
                          <td class="text-left" style="width: 40%;"><input type="text" name="product_attribute[{{ attribute_row }}][name]" value="{{ product_attribute.name }}" placeholder="{{ entry_attribute }}" class="form-control"/> <input type="hidden" name="product_attribute[{{ attribute_row }}][attribute_id]" value="{{ product_attribute.attribute_id }}"/></td>
                          <td class="text-left">{% for language in languages %}
                              <div class="input-group"><span class="input-group-addon"><img src="catalog/language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}"/></span> <textarea name="product_attribute[{{ attribute_row }}][product_attribute_description][{{ language.language_id }}][text]" rows="5" placeholder="{{ entry_text }}" class="form-control">{{ product_attribute.product_attribute_description[language.language_id] ? product_attribute.product_attribute_description[language.language_id].text }}</textarea>
                              </div>
                            {% endfor %}</td>
                          <td class="text-left"><button type="button" onclick="$('#attribute-row{{ attribute_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                        </tr>
                        {% set attribute_row = attribute_row + 1 %}
                      {% endfor %}
                      </tbody>
                      <tfoot>
                      <tr>
                        <td colspan="2"></td>
                        <td class="text-left"><button type="button" onclick="addAttribute();" data-toggle="tooltip" title="{{ button_attribute_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                      </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
                <div class="tab-pane" id="tab-discount">
                  <h2>{{ tab_discount }}</h2>
                  <div class="table-responsive">
                    <table id="discount" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-left">{{ entry_customer_group }}</td>
                          <td class="text-right">{{ entry_quantity }}</td>
                          <td class="text-right">{{ entry_priority }}</td>
                          <td class="text-right">{{ entry_price }}</td>
                          <td class="text-left">{{ entry_date_start }}</td>
                          <td class="text-left">{{ entry_date_end }}</td>
                          <td></td>
                        </tr>
                      </thead>
                      <tbody>
                        {% set discount_row = 0 %}
                        {% for product_discount in product_discounts %}
                          <tr id="discount-row{{ discount_row }}">
                            <td class="text-left"><select name="product_discount[{{ discount_row }}][customer_group_id]" class="form-control">
                                {% for customer_group in customer_groups %}
                                  {% if customer_group.customer_group_id == product_discount.customer_group_id %}
                                    <option value="{{ customer_group.customer_group_id }}" selected="selected">{{ customer_group.name }}</option>
                                  {% else %}
                                    <option value="{{ customer_group.customer_group_id }}">{{ customer_group.name }}</option>
                                  {% endif %}
                                {% endfor %}
                              </select></td>
                            <td class="text-right"><input type="text" name="product_discount[{{ discount_row }}][quantity]" value="{{ product_discount.quantity }}" placeholder="{{ entry_quantity }}" class="form-control"/></td>
                            <td class="text-right"><input type="text" name="product_discount[{{ discount_row }}][priority]" value="{{ product_discount.priority }}" placeholder="{{ entry_priority }}" class="form-control"/></td>
                            <td class="text-right"><input type="text" name="product_discount[{{ discount_row }}][price]" value="{{ product_discount.price }}" placeholder="{{ entry_price }}" class="form-control"/></td>
                            <td class="text-left" style="width: 20%;">
                              <div class="input-group date">
                                <input type="text" name="product_discount[{{ discount_row }}][date_start]" value="{{ product_discount.date_start }}" placeholder="{{ entry_date_start }}" data-date-format="YYYY-MM-DD" class="form-control"/>
                                <div class="input-group-btn">
                                  <button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
                                </div>
                              </div>
                            </td>
                            <td class="text-left" style="width: 20%;">
                              <div class="input-group date">
                                <input type="text" name="product_discount[{{ discount_row }}][date_end]" value="{{ product_discount.date_end }}" placeholder="{{ entry_date_end }}" data-date-format="YYYY-MM-DD" class="form-control"/>
                                <div class="input-group-btn">
                                  <button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
                                </div>
                              </div>
                            </td>
                            <td class="text-left"><button type="button" onclick="$('#discount-row{{ discount_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                          </tr>
                          {% set discount_row = discount_row + 1 %}
                        {% endfor %}
                      </tbody>
                      <tfoot>
                      <tr>
                        <td colspan="6"></td>
                        <td class="text-left"><button type="button" onclick="addDiscount();" data-toggle="tooltip" title="{{ button_discount_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                      </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
                <div class="tab-pane" id="tab-special">
                  <h2>{{ tab_special }}</h2>
                  <div class="table-responsive">
                    <table id="special" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-left">{{ entry_customer_group }}</td>
                          <td class="text-right">{{ entry_priority }}</td>
                          <td class="text-right">{{ entry_price }}</td>
                          <td class="text-left">{{ entry_date_start }}</td>
                          <td class="text-left">{{ entry_date_end }}</td>
                          <td></td>
                        </tr>
                      </thead>
                      <tbody>
                        {% set special_row = 0 %}
                        {% for product_special in product_specials %}
                          <tr id="special-row{{ special_row }}">
                            <td class="text-left"><select name="product_special[{{ special_row }}][customer_group_id]" class="form-control">
                                {% for customer_group in customer_groups %}
                                  {% if customer_group.customer_group_id == product_special.customer_group_id %}
                                    <option value="{{ customer_group.customer_group_id }}" selected="selected">{{ customer_group.name }}</option>
                                  {% else %}
                                    <option value="{{ customer_group.customer_group_id }}">{{ customer_group.name }}</option>
                                  {% endif %}
                                {% endfor %}
                              </select></td>
                            <td class="text-right"><input type="text" name="product_special[{{ special_row }}][priority]" value="{{ product_special.priority }}" placeholder="{{ entry_priority }}" class="form-control"/></td>
                            <td class="text-right"><input type="text" name="product_special[{{ special_row }}][price]" value="{{ product_special.price }}" placeholder="{{ entry_price }}" class="form-control"/></td>
                            <td class="text-left" style="width: 20%;">
                              <div class="input-group date">
                                <input type="text" name="product_special[{{ special_row }}][date_start]" value="{{ product_special.date_start }}" placeholder="{{ entry_date_start }}" data-date-format="YYYY-MM-DD" class="form-control"/>
                                <div class="input-group-btn">
                                  <button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
                                </div>
                              </div>
                            </td>
                            <td class="text-left" style="width: 20%;">
                              <div class="input-group date">
                                <input type="text" name="product_special[{{ special_row }}][date_end]" value="{{ product_special.date_end }}" placeholder="{{ entry_date_end }}" data-date-format="YYYY-MM-DD" class="form-control"/>
                                <div class="input-group-btn">
                                  <button class="btn btn-default" type="button"><i class="fa fa-calendar"></i></button>
                                </div>
                              </div>
                            </td>
                            <td class="text-left"><button type="button" onclick="$('#special-row{{ special_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                          </tr>
                          {% set special_row = special_row + 1 %}
                        {% endfor %}
                      </tbody>
                      <tfoot>
                        <tr>
                          <td colspan="5"></td>
                          <td class="text-left"><button type="button" onclick="addSpecial();" data-toggle="tooltip" title="{{ button_special_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
                <div class="tab-pane" id="tab-image">
                  <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-left">{{ entry_image }}</td>
                        </tr>
                      </thead>
                      <tbody>
                      <tr>
                        <td class="text-left"><a href="" id="thumb-image" data-toggle="image" class="img-thumbnail"><img src="{{ thumb }}" alt="" title="" data-placeholder="{{ placeholder }}"/></a> <input type="hidden" name="image" value="{{ image }}" id="input-image"/></td>
                      </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="table-responsive">
                    <table id="images" class="table table-striped table-bordered table-hover">
                      <thead>
                        <tr>
                          <td class="text-left">{{ entry_additional_image }}</td>
                          <td class="text-right">{{ entry_sort_order }}</td>
                          <td></td>
                        </tr>
                      </thead>
                      <tbody>
                        {% set image_row = 0 %}
                        {% for product_image in product_images %}
                          <tr id="image-row{{ image_row }}">
                            <td class="text-left"><a href="" id="thumb-image{{ image_row }}" data-toggle="image" class="img-thumbnail product-img"><img src="{{ product_image.thumb }}" alt="" title="" data-placeholder="{{ placeholder }}"/></a> <input type="hidden" name="product_image[{{ image_row }}][image]" value="{{ product_image.image }}" id="input-image{{ image_row }}"/></td>
                            <td class="text-right"><input type="text" name="product_image[{{ image_row }}][sort_order]" value="{{ product_image.sort_order }}" placeholder="{{ entry_sort_order }}" class="form-control"/></td>
                            <td class="text-left"><button type="button" onclick="$('#image-row{{ image_row }}').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>
                          </tr>
                          {% set image_row = image_row + 1 %}
                        {% endfor %}
                      </tbody>
                      <tfoot>
                        <tr>
                          <td colspan="2"></td>
                          <td class="text-left"><button type="button" onclick="addImage();" data-toggle="tooltip" title="{{ button_image_add }}" class="btn btn-primary"><i class="fa fa-plus-circle"></i></button></td>
                        </tr>
                      </tfoot>
                    </table>
                  </div>
                </div>
                <div class="tab-pane" id="tab-download">
                  <h2>{{ tab_download }}</h2>
                  <a href="javascript:;" id="link-download" data-toggle="tooltip" title="" class="btn btn-primary" data-original-title="{{ text_select_field }}"><i class="fa fa-upload"></i></a>
                  <input type="file" name="download-file" id="download-file" class="download-file hidden">
                  <div id="product-download" class="well well-sm" style="min-height: 150px; overflow: auto;">
                    {% for product_download in product_downloads %}
                      <div id="product-download{{ product_download.download_id }}"><i class="fa fa-minus-circle"></i> {{ product_download.name }}
                        <input type="hidden" name="product_download[]" value="{{ product_download.download_id }}"/>
                      </div>
                    {% endfor %}
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    {{ content_bottom }}
  </div>
  <script type="text/javascript">
    // Variant
    $('#save-variant').click(function() {
      $('input[name=\'save_variant\']').val(1);
      $('#form-product').submit();
    });
  </script>
  <script type="text/javascript">

    $('.date').datetimepicker({
      language: '{{ datepicker }}',
      pickTime: false
    });

    $('#language a:first').tab('show');

    // category
    $('input[name=\'category\']').autocomplete({
      'source': function(request, response) {
        $.ajax({
          url: 'index.php?route=seller/product/categoryComplete&filter_name=' + encodeURIComponent(request),
          dataType: 'json',
          success: function(json) {
            response($.map(json, function(item) {
              return {
                label: item['name'],
                value: item['category_id']
              }
            }));
          }
        });
      },
      'select': function(item) {
        $('input[name=\'category\']').val('');

        $('#product-category' + item['value']).remove();

        $('#product-category').append('<div id="product-category' + item['value'] + '" class="ui-sortable-handle"><i class="fa fa-minus-circle"></i> ' + item['label'] + '<input type="hidden" name="product_category[]" value="' + item['value'] + '" /></div>');
      }
    });
    $('#product-category').delegate('.fa-minus-circle', 'click', function() {
      $(this).parent().remove();
    });

    // Images
    var image_row = $('#images').find('tbody tr').length;
    function addImage() {
      html = '<tr id="image-row' + image_row + '">';
      html += '  <td class="text-left"><a href="" id="thumb-image' + image_row + '"data-toggle="image" class="img-thumbnail product-img"><img src="{{ placeholder }}" alt="" title="" data-placeholder="{{ placeholder }}" /></a><input type="hidden" name="product_image[' + image_row + '][image]" value="" id="input-image' + image_row + '" /></td>';
      html += '  <td class="text-right"><input type="text" name="product_image[' + image_row + '][sort_order]" value="" placeholder="{{ entry_sort_order }}" class="form-control" /></td>';
      html += '  <td class="text-left"><button type="button" onclick="$(\'#image-row' + image_row + '\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
      html += '</tr>';

      $('#images tbody').append(html);

      image_row++;
    }

    // Manufactures
    $('input[name=\'manufacturer\']').autocomplete({
      'source': function(request, response) {
        $.ajax({
          url: 'index.php?route=seller/product/manufacturerComplete&filter_name=' + encodeURIComponent(request),
          dataType: 'json',
          success: function(json) {
            json.unshift({
              manufacturer_id: 0,
              name: '{{ text_none }}'
            });

            response($.map(json, function(item) {
              return {
                label: item['name'],
                value: item['manufacturer_id']
              }
            }));
          }
        });
      },
      'select': function(item) {
        $('input[name=\'manufacturer\']').val(item['label']);
        $('input[name=\'manufacturer_id\']').val(item['value']);
      }
    });

    // Related
    $('input[name=\'related\']').autocomplete({
      'source': function(request, response) {
        $.ajax({
          url: 'index.php?route=seller/product/productComplete&filter_name=' + encodeURIComponent(request),
          dataType: 'json',
          success: function(json) {
            response($.map(json, function(item) {
              return {
                label: item['name'],
                value: item['product_id']
              }
            }));
          }
        });
      },
      'select': function(item) {
        $('input[name=\'related\']').val('');

        $('#product-related' + item['value']).remove();

        $('#product-related').append('<div id="product-related' + item['value'] + '" class="ui-sortable-handle"><i class="fa fa-minus-circle"></i> ' + item['label'] + '<input type="hidden" name="product_related[]" value="' + item['value'] + '" /></div>');
      }
    });

    $('#product-related').delegate('.fa-minus-circle', 'click', function() {
      $(this).parent().remove();
    });
    var attribute_row = {{ attribute_row }};
    function addAttribute() {
      html = '<tr id="attribute-row' + attribute_row + '">';
      html += '  <td class="text-left" style="width: 20%;"><input type="text" name="product_attribute[' + attribute_row + '][name]" value="" placeholder="{{ entry_attribute }}" class="form-control" /><input type="hidden" name="product_attribute[' + attribute_row + '][attribute_id]" value="" /></td>';
      html += '  <td class="text-left">';
      {% for language in languages %}
      html += '<div class="input-group"><span class="input-group-addon"><img src="catalog/language/{{ language.code }}/{{ language.code }}.png" title="{{ language.name }}" /></span><textarea name="product_attribute[' + attribute_row + '][product_attribute_description][{{ language.language_id }}][text]" rows="5" placeholder="{{ entry_text }}" class="form-control"></textarea></div>';
      {% endfor %}
      html += '  </td>';
      html += '  <td class="text-left"><button type="button" onclick="$(\'#attribute-row' + attribute_row + '\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
      html += '</tr>';

      $('#attribute tbody').append(html);

      attributeautocomplete(attribute_row);

      attribute_row++;
    }

    function attributeautocomplete(attribute_row) {
      $('input[name=\'product_attribute[' + attribute_row + '][name]\']').autocomplete({
        'source': function(request, response) {
          $.ajax({
            url: 'index.php?route=seller/product/attributeComplete&user_token={{ user_token }}&filter_name=' + encodeURIComponent(request),
            dataType: 'json',
            success: function(json) {
              response($.map(json, function(item) {
                return {
                  category: item.attribute_group,
                  label: item.name,
                  value: item.attribute_id
                }
              }));
            }
          });
        },
        'select': function(item) {
          $('input[name=\'product_attribute[' + attribute_row + '][name]\']').val(item['label']);
          $('input[name=\'product_attribute[' + attribute_row + '][attribute_id]\']').val(item['value']);
        }
      });
    }

    $('#attribute tbody tr').each(function(index, element) {
      attributeautocomplete(index);
    });

    // Discount
    var discount_row = '{{ discount_row }}';

    function addDiscount() {
      html = '<tr id="discount-row' + discount_row + '">';
      html += '  <td class="text-left"><select name="product_discount[' + discount_row + '][customer_group_id]" class="form-control">';
      {% for customer_group in customer_groups %}
      html += '    <option value="{{ customer_group.customer_group_id }}">{{ customer_group.name|escape('js') }}</option>';
      {% endfor %}
      html += '  </select></td>';
      html += '  <td class="text-right"><input type="text" name="product_discount[' + discount_row + '][quantity]" value="" placeholder="{{ entry_quantity }}" class="form-control" /></td>';
      html += '  <td class="text-right"><input type="text" name="product_discount[' + discount_row + '][priority]" value="" placeholder="{{ entry_priority }}" class="form-control" /></td>';
      html += '  <td class="text-right"><input type="text" name="product_discount[' + discount_row + '][price]" value="" placeholder="{{ entry_price }}" class="form-control" /></td>';
      html += '  <td class="text-left" style="width: 20%;"><div class="input-group date"><input type="text" name="product_discount[' + discount_row + '][date_start]" value="" placeholder="{{ entry_date_start }}" data-date-format="YYYY-MM-DD" class="form-control" /><div class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></div></div></td>';
      html += '  <td class="text-left" style="width: 20%;"><div class="input-group date"><input type="text" name="product_discount[' + discount_row + '][date_end]" value="" placeholder="{{ entry_date_end }}" data-date-format="YYYY-MM-DD" class="form-control" /><div class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></div></div></td>';
      html += '  <td class="text-left"><button type="button" onclick="$(\'#discount-row' + discount_row + '\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
      html += '</tr>';

      $('#discount tbody').append(html);

      $('.date').datetimepicker({
        language: '{{ datepicker }}',
        pickTime: false
      });

      discount_row++;
    }

    // Special
    var special_row = '{{ special_row }}';

    function addSpecial() {
      html = '<tr id="special-row' + special_row + '">';
      html += '  <td class="text-left"><select name="product_special[' + special_row + '][customer_group_id]" class="form-control">';
      {% for customer_group in customer_groups %}
      html += '      <option value="{{ customer_group.customer_group_id }}">{{ customer_group.name|escape('js') }}</option>';
      {% endfor %}
      html += '  </select></td>';
      html += '  <td class="text-right"><input type="text" name="product_special[' + special_row + '][priority]" value="" placeholder="{{ entry_priority }}" class="form-control" /></td>';
      html += '  <td class="text-right"><input type="text" name="product_special[' + special_row + '][price]" value="" placeholder="{{ entry_price }}" class="form-control" /></td>';
      html += '  <td class="text-left" style="width: 20%;"><div class="input-group date"><input type="text" name="product_special[' + special_row + '][date_start]" value="" placeholder="{{ entry_date_start }}" data-date-format="YYYY-MM-DD" class="form-control" /><div class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></div></div></td>';
      html += '  <td class="text-left" style="width: 20%;"><div class="input-group date"><input type="text" name="product_special[' + special_row + '][date_end]" value="" placeholder="{{ entry_date_end }}" data-date-format="YYYY-MM-DD" class="form-control" /><div class="input-group-btn"><button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></div></div></td>';
      html += '  <td class="text-left"><button type="button" onclick="$(\'#special-row' + special_row + '\').remove();" data-toggle="tooltip" title="{{ button_remove }}" class="btn btn-danger"><i class="fa fa-minus-circle"></i></button></td>';
      html += '</tr>';

      $('#special tbody').append(html);

      $('.date').datetimepicker({
        language: '{{ datepicker }}',
        pickTime: false
      });

      special_row++;
    }

    // Downloads
    $(document).on('click', '#link-download', function() {
      $('#download-file').click();
    });

    $(document).on('change', '.download-file', function() {
      var $this = $(this);
      var attr_id = $this.attr('id');
      fileUpload(attr_id);
      $this.remove();
      $('#link-download').after('<input type="file" name="download-file" id="download-file-' + Date.parse(new Date()) + '" class="download-file hidden">');
    });

    function fileUpload(ele_id) {
      var upload_index = layer.load( 2, {
        shade: [0.1,'#000']
      });
      $.ajaxFileUpload({
        url : 'index.php?route=seller/product/fileUpload',
        type : 'post',
        secureuri : false,
        fileElementId : ele_id,
        dataType : 'json',
        success : function(json){
          layer.close(upload_index);
          layer.msg(json['msg']);
          if (json['code']) {
            $('#product-download').append('<div id="product-download' + json['id'] + '"><i class="fa fa-minus-circle"></i> ' + json['name'] + '<input type="hidden" name="product_download[]" value="' + json['id'] + '" /></div>');
          }
        },
        error:function(data,status,e){
          console.log(e);
        }
      });
    }

    $('#product-download').delegate('.fa-minus-circle', 'click', function() {
      $(this).parent().remove();
    });
  </script>
{% endblock %}